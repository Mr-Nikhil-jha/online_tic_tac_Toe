let resetInitiator = null; // Keep track of who initiated the reset

async function resetGame() {
  if (!gameActive) return;

  // Reset the game state
  await currentRoom.update({
    gameState: ["", "", "", "", "", "", "", "", ""],
    currentPlayer: "X", // Reset to player X's turn
    winner: null,
    gameActive: true,
    status: "waiting",
  });

  // Mark who initiated the reset
  resetInitiator = playerNameInput.value.trim();

  // Disable cell interaction for the other player
  disableCellInteraction();

  // Update the UI for reset status
  status.textContent = "Game reset. Waiting for opponent...";
  resetBtn.style.display = "none";
}

function disableCellInteraction() {
  cells.forEach(cell => {
    cell.style.pointerEvents = 'none'; // Disable clicking on cells
  });
}

function enableCellInteraction() {
  cells.forEach(cell => {
    cell.style.pointerEvents = 'auto'; // Enable clicking on cells
  });
}

// Modify the reset button's behavior
resetBtn.addEventListener("click", async () => {
  await resetGame();

  // Enable the other player's interaction if they're allowed
  if (resetInitiator !== playerNameInput.value.trim()) {
    enableCellInteraction();
  }
});
